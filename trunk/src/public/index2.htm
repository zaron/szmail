<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>szMail</title>
<link rel="stylesheet" href="css/layout2.css" />

<script type="text/javascript" src="lib/yabble.js"></script>
<script type="text/javascript" src="lib/jquery.js"></script>
<script type="text/javascript" src="lib/pure.js"></script>
<script type="text/javascript" src="folders.js"></script>
<script type="text/javascript" src="mails.js"></script>
<script type="text/javascript" src="frontend.js"></script>

<script type="text/javascript">

function toDate(str)
{
	var months = {'Jan':1,'Feb':2,'Mar':3,'Apr':4,'May':5,'Jun':6,'Jul':7,'Aug':8,'Sep':9,'Oct':10,'Nov':11,'Dec':12};
	// Wed, 10 Mar 2010 22:55:11 +0100
	var str = str.split(' ');
	var daytime = str[4].split(':');
	return new Date(str[3], months[str[2]], str[1], daytime[0], daytime[1], daytime[2]);
}

function convenienceDate(date){
	return date.toDateString();
}

$(function () {

	$(".dropdown dt").click(function() {
		$(".dropdown dt").css("-moz-border-radius","3px 3px 0 0");
	    $(".dropdown dd ul").toggle();
	});
	
    $(document).bind('click', function(e) {
        var $clicked = $(e.target);
        if (! $clicked.parents().hasClass("dropdown"))
        {
        	$(".dropdown dt").css("-moz-border-radius","3px");
        	$(".dropdown dd ul").hide();
        }
            
    });
    


	var filter = function(a) {
		return (a.item.type != "");
	};
	var directive = {
		'li.tpl' : {
			'folder<-folders' : {
				'a.link' : {'span' : 'folder.mails'},
				'a.link' : function(a) {
					if(a.item.unread) return a.item.name +' (' + a.item.unread + ')';
					return a.item.name;
				},
				'a.link@href' : '#!/#{folder.global}/?',
				'img@class' : function(a) { return a.item.type.toLowerCase();}
			},
			sort : function(a, b) {
				return a.name > b.name ? 1 : -1;
			},
			filter : filter
		}
	};
	$('#special_folders').render(folders,directive);
	directive['li.tpl'].filter = function(a) {
		return (a.item.type == "");
	};
	$('#folders').render(folders,directive);
	
	directive = {
		'tr' : {
			'mail<-mails' : {
				//'td.checkbox'   : '',
				'td.attachment a@class' : function(a){ return ((a.item.attachment) ? '' : 'no') + 'attachment';},
				'td.subject a'          : 'mail.subject',
				'td.subject a@href'          : Navigator.getPath(),
				'td.from'       : 'mail.from',
				'td.date'       : function(a){
					return convenienceDate(toDate(a.item.date));
				},
				'td.size'       : 'mail.size'
			}
		}
	};
	
	$('tbody').render(mails, directive);
	
	
	

		var activeSuggestion = $('#suggest ul li:first');
		activeSuggestion.toggleClass('active');
		$('#searchbox').keydown(function(event) {
			if (event.keyCode == '13') {
				event.preventDefault();
			} else if (event.keyCode == '38') { // arrow up
				activeSuggestion.toggleClass('active');
			} else if (event.keyCode == '40') { // arrow down

			}

		});
		$('#searchbox').focus(function(event) {
			$('#suggest').slideDown('normal');
		});
		$('#searchbox').blur(function(event) {
			$('#suggest').slideUp('normal');
		});

	});
</script>
</head>
<body>

<div id="debug"></div>
      <div id="header">
            <div id="logo"><h1><a>szMail</a></h1>
            	<div id="headerbar">Willkommen, <a href="">Eric Barmeyer</a> | <a href="">Accounteinstellungen</a> | <a href="" class="logout">Abmelden</a></div>
            </div>
        </div>
        <div id="wrapper">

<!-- begin: navigation -->
        	<div id="navigation">
            	<div id="inbox_switcher">
					<dl class="dropdown">
						<dt><a href="#"><span><img src="/images/placeholder.png" class="gmail" alt="" />enrico.grot@gmail.com</span></a></dt>
						<dd>
							<ul>							
								<li><a href="#"><span><img src="/images/placeholder.png" class="all" alt="" />Alle Posteing&auml;nge</span></a></li>
								<li class="separator"></li>
								<li><a href="#"><span><img src="/images/placeholder.png" class="gmail" alt="" />enrico.grot@gmail.com</span></a></li>
								<li><a href="#"><span><img src="/images/placeholder.png" class="gmx" alt="" />foobar@gmx.com</span></a></li>
							</ul>
						</dd>
					</dl>
            	</div>
            
                <div id="inbox_navigation">
                    <ul id="special_folders">
                    	<li class="tpl"><img src="/images/placeholder.png" alt="" /><a class="link"><span/></a></li>
                        <li class="n separator"></li>
                    </ul>

                    <h3>Ordner</h3>
                    <ul id="folders">
						<li class="tpl"><img src="/images/placeholder.png" alt="" /><a class="link"><span/></a></li>
                        <li class="n separator"></li>
                        <li class="n"><img src="/images/placeholder.png" class="add_folder" alt="" /><a>Ordner hinzuf&uuml;gen</a></li>
                        <li class="n"><img src="/images/placeholder.png" class="edit_folder" alt="" /><a>Ordner verwalten</a></li>
                    </ul>
                </div>
            </div>
<!-- end: navigation -->

<!-- begin: content -->
			<div id="content">
                <div id="universalbar">
                <div id="universalbar_wrapper">
                    <div id="reload_button"><a href="#"><img src="/images/placeholder.png" alt=""/></a></div>
                    <div class="spacer"></div>
                    <div id="compose_button"><a href="#"><img src="/images/placeholder.png" alt=""/>Neue Nachricht</a></div>
                    <div class="spacer"></div>
                    <div id="search">
                   		<a class="search"><img src="/images/placeholder.png" alt=""/></a>
						<a class="go" href="#"><img src="/images/placeholder.png" alt=""/></a>
                   		<div id="searchbar"> 
                    		<div id="suggest">
                                <ul>
                                    <li class="search_mails"><a>Nachrichten mit diesem Absender suchen<br/><span class="subject">Von: <span class="email">eric.barmeyer@rwth-aachen.de</span></span></a></li>
                                    <li class="new_mail"><a>Neue Nachricht verfassen<br/><span class="subject">An: <span class="email">eric.barmeyer@rwth-aachen.de</span></span></a></li>
                                </ul>
                            </div><input id="searchbox" autocomplete="off" type="text" name="search" />
						</div> 
					</div>
				</div>
                </div>
                
                <!--<div id="notifications">
                    <div class="notification"><p class="ok">Everythings fine.</p></div>
                    <div class="notification"><p class="warning">Quota is at 89%.</p></div>
                </div>-->
                
                
                <div id="content_wrapper" class="content_wrapper">
                
                	<div class="content" id="view_mail">
                	
	                	<div class="menu noborder">
							<div class="left"><ul class="breadcrumbs">
							    <li><a><img src="/images/placeholder.png" alt="" class="home" /></a></li>
							    <li><a>Archiv</a></li>
							    <li><a>2010</a></li>
							    <li>M&auml;rz</li>
							</ul></div>
							<div class="right pagination"><a>Nachrichten 1 - 20 von 1234</a></div>
						</div>
						<table id="mail_table" cellspacing="0">
						
								<thead>
									<tr>
										<th scope="col" class="checkbox"><img src="/images/placeholder.png" alt="" /></th>
										<th scope="col" class="attachment"><img src="/images/placeholder.png" alt="" /><a class="order"><img src="/images/placeholder.png" alt="" /></a></th>
										<th scope="col" class="subject">Betreff<a class="order"><img src="/images/placeholder.png" alt="" /></a></th>
										<th scope="col" class="from">Absender<a class="order"><img src="/images/placeholder.png" alt="" /></a></th>
										<th scope="col" class="date">Datum<a class="order"><img src="/images/placeholder.png" alt="" /></a></th>
										<th scope="col" class="size">Gr&ouml;&szlig;e<a class="order"><img src="/images/placeholder.png" alt="" /></a></th>
									</tr>
								</thead>
							
								<tbody>
									<tr>
										<td class="checkbox"><div class="checkbox"><input type="checkbox" name="" /></div></td>
					 					<td class="attachment"><a class="attachment"></a></td>
					 					<td class="subject"><b><a><i>mail.subject</i></a></b></td>
					 					<td class="from"><a class="">mail.from</a></td>
					 					<td class="date">mail.date</td>
					 					<td class="size">mail.size</td>
					 				</tr>
								</tbody>
							
						</table>
							
						<div class="menu noborder">
							<div class="left"></div>
							<div class="right pagination"><a>Nachrichten 1 - 20 von 1234</a></div>
						</div>
                	
                	</div>
                
                </div>
			</div>
<!-- end: content -->

<!-- begin: clear -->
			<div class="clear"></div>
<!-- end: clear -->
			
        </div>
        <div id="footer">powered by szMail</div>
</body>

</html>